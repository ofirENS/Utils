<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T2U3">vals</span> = Acoeff(<span class="var type1" id="S3T1U6">ksi</span>,<span class="var type1" id="S4T1U7">j</span>,<span class="var type1" id="S5T2U8">x</span>,<span class="var type1" id="S6T1U9">t</span>,<span class="var type1" id="S7T2U10">gridT</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% evaluate the coefficient A at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T3:U7"><span class="var type1" id="S6T1U14">t</span>&lt;=<span class="mxinfo" id="T1:U9"><span class="var type1" id="S7T2U16">gridT</span>(<span class="var type1" id="S4T1U17">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T2:U12"><span class="var type1" id="S2T2U20">vals</span>=<span class="mxinfo" id="T1:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U15">all(<span class="mxinfo" id="T46:U16">[<span class="mxinfo" id="T3:U17"><span class="var type1" id="S6T1U28">t</span>&gt;<span class="mxinfo" id="T1:U19"><span class="var type1" id="S7T2U30">gridT</span>(<span class="var type1" id="S4T1U31">j</span>)</span></span>, <span class="mxinfo" id="T3:U22"><span class="var type1" id="S6T1U33">t</span>&lt;= <span class="mxinfo" id="T1:U24"><span class="var type1" id="S7T2U35">gridT</span>(<span class="mxinfo" id="T1:U26"><span class="var type1" id="S4T1U37">j</span>+<span class="mxinfo" id="T1:U28">1</span></span>)</span></span>, <span class="mxinfo" id="T46:U29"><span class="var type1" id="S5T2U40">x</span>==<span class="var type1" id="S3T1U41">ksi</span></span>]</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T2:U32"><span class="var type1" id="S2T2U44">vals</span> = <span class="mxinfo" id="T1:U34">sqrt(<span class="mxinfo" id="T1:U35">(<span class="mxinfo" id="T1:U36"><span class="var type1" id="S6T1U50">t</span>-<span class="mxinfo" id="T1:U38"><span class="var type1" id="S7T2U52">gridT</span>(<span class="var type1" id="S4T1U53">j</span>)</span></span>)/<span class="mxinfo" id="T1:U41">pi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U42">all(<span class="mxinfo" id="T46:U43">[<span class="mxinfo" id="T3:U44"><span class="var type1" id="S6T1U62">t</span>&gt;<span class="mxinfo" id="T1:U46"><span class="var type1" id="S7T2U64">gridT</span>(<span class="var type1" id="S4T1U65">j</span>)</span></span>, <span class="mxinfo" id="T3:U49"><span class="var type1" id="S6T1U67">t</span>&lt;= <span class="mxinfo" id="T1:U51"><span class="var type1" id="S7T2U69">gridT</span>(<span class="mxinfo" id="T1:U53"><span class="var type1" id="S4T1U71">j</span>+<span class="mxinfo" id="T1:U55">1</span></span>)</span></span>, <span class="mxinfo" id="T46:U56"><span class="var type1" id="S5T2U74">x</span>~=<span class="var type1" id="S3T1U75">ksi</span></span>]</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo" id="T2:U59"><span class="var type1" id="S11T2U78">z0</span> = <span class="mxinfo" id="T2:U61"><span class="mxinfo" id="T2:U62">abs(<span class="mxinfo" id="T2:U63"><span class="var type1" id="S5T2U83">x</span>-<span class="var type1" id="S3T1U84">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U66"><span class="mxinfo" id="T1:U67">2</span>*<span class="mxinfo" id="T1:U68">sqrt(<span class="mxinfo" id="T1:U69"><span class="var type1" id="S6T1U91">t</span>-<span class="mxinfo" id="T1:U71"><span class="var type1" id="S7T2U93">gridT</span>(<span class="var type1" id="S4T1U94">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo" id="T2:U74"><span class="var type1" id="S2T2U97">vals</span> = <span class="mxinfo" id="T2:U76">(<span class="mxinfo" id="T2:U77"><span class="mxinfo" id="T2:U78">abs(<span class="mxinfo" id="T2:U79"><span class="var type1" id="S5T2U104">x</span>-<span class="var type1" id="S3T1U105">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U82">2*sqrt(pi)</span>)</span>)*(<span class="mxinfo" id="T2:U83">(<span class="mxinfo" id="T2:U84"><span class="mxinfo" id="T2:U85">exp(<span class="mxinfo" id="T2:U86">-<span class="mxinfo" id="T2:U87"><span class="var type1" id="S11T2U121">z0</span>^2</span></span>)</span>/<span class="var type1" id="S11T2U123">z0</span></span>) - <span class="mxinfo" id="T2:U90"><span class="mxinfo" id="T1:U91">sqrt(pi)</span>*<span class="mxinfo" id="T2:U92">erfc(<span class="var type1" id="S11T2U131">z0</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U94">all(<span class="mxinfo" id="T46:U95">[<span class="mxinfo" id="T3:U96"><span class="var type1" id="S6T1U138">t</span>&gt;<span class="mxinfo" id="T1:U98"><span class="var type1" id="S7T2U140">gridT</span>(<span class="mxinfo" id="T1:U100"><span class="var type1" id="S4T1U142">j</span>+<span class="mxinfo" id="T1:U102">1</span></span>)</span></span>, <span class="mxinfo" id="T46:U103"><span class="var type1" id="S5T2U145">x</span>==<span class="var type1" id="S3T1U146">ksi</span></span>]</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo" id="T2:U106"><span class="var type1" id="S2T2U149">vals</span> = <span class="mxinfo" id="T1:U108"><span class="mxinfo" id="T1:U109">sqrt(<span class="mxinfo" id="T1:U110">(<span class="mxinfo" id="T1:U111"><span class="var type1" id="S6T1U156">t</span>-<span class="mxinfo" id="T1:U113"><span class="var type1" id="S7T2U158">gridT</span>(<span class="var type1" id="S4T1U159">j</span>)</span></span>)/<span class="mxinfo" id="T1:U116">pi</span></span>)</span>-<span class="mxinfo" id="T1:U117">sqrt(<span class="mxinfo" id="T1:U118">(<span class="mxinfo" id="T1:U119"><span class="var type1" id="S6T1U167">t</span>-<span class="mxinfo" id="T1:U121"><span class="var type1" id="S7T2U169">gridT</span>(<span class="mxinfo" id="T1:U123"><span class="var type1" id="S4T1U171">j</span>+<span class="mxinfo" id="T1:U125">1</span></span>)</span></span>)/<span class="mxinfo" id="T1:U126">pi</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U127">all(<span class="mxinfo" id="T46:U128">[<span class="mxinfo" id="T3:U129"><span class="var type1" id="S6T1U181">t</span>&gt;<span class="mxinfo" id="T1:U131"><span class="var type1" id="S7T2U183">gridT</span>(<span class="mxinfo" id="T1:U133"><span class="var type1" id="S4T1U185">j</span>+<span class="mxinfo" id="T1:U135">1</span></span>)</span></span>, <span class="mxinfo" id="T46:U136"><span class="var type1" id="S5T2U188">x</span>~=<span class="var type1" id="S3T1U189">ksi</span></span>]</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo" id="T2:U139"><span class="var type1" id="S11T2U192">z0</span> = <span class="mxinfo" id="T2:U141"><span class="mxinfo" id="T2:U142">abs(<span class="mxinfo" id="T2:U143"><span class="var type1" id="S5T2U197">x</span>-<span class="var type1" id="S3T1U198">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U146"><span class="mxinfo" id="T1:U147">2</span>*<span class="mxinfo" id="T1:U148">sqrt(<span class="mxinfo" id="T1:U149"><span class="var type1" id="S6T1U205">t</span>-<span class="mxinfo" id="T1:U151"><span class="var type1" id="S7T2U207">gridT</span>(<span class="var type1" id="S4T1U208">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo" id="T2:U154"><span class="var type1" id="S15T2U211">z1</span> = <span class="mxinfo" id="T2:U156"><span class="mxinfo" id="T2:U157">abs(<span class="mxinfo" id="T2:U158"><span class="var type1" id="S5T2U216">x</span>-<span class="var type1" id="S3T1U217">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U161"><span class="mxinfo" id="T1:U162">2</span>*<span class="mxinfo" id="T1:U163">sqrt(<span class="mxinfo" id="T1:U164"><span class="var type1" id="S6T1U224">t</span>-<span class="mxinfo" id="T1:U166"><span class="var type1" id="S7T2U226">gridT</span>(<span class="mxinfo" id="T1:U168"><span class="var type1" id="S4T1U228">j</span>+<span class="mxinfo" id="T1:U170">1</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo" id="T2:U171"><span class="var type1" id="S2T2U232">vals</span> = <span class="mxinfo" id="T2:U173">(<span class="mxinfo" id="T2:U174"><span class="mxinfo" id="T2:U175">abs(<span class="mxinfo" id="T2:U176"><span class="var type1" id="S5T2U239">x</span>-<span class="var type1" id="S3T1U240">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U179">2*sqrt(pi)</span>)</span>)*(<span class="mxinfo" id="T2:U180"><span class="mxinfo" id="T2:U181">(<span class="mxinfo" id="T2:U182"><span class="mxinfo" id="T2:U183">exp(<span class="mxinfo" id="T2:U184">-(<span class="mxinfo" id="T2:U185"><span class="var type1" id="S11T2U258">z0</span>^2</span>)</span>)</span>/<span class="var type1" id="S11T2U260">z0</span></span>) - <span class="mxinfo" id="T2:U188"><span class="mxinfo" id="T2:U189">exp(<span class="mxinfo" id="T2:U190">-(<span class="mxinfo" id="T2:U191"><span class="var type1" id="S15T2U267">z1</span>^2</span>)</span>)</span>/<span class="var type1" id="S15T2U269">z1</span></span></span> +<span class="mxinfo" id="T2:U194"><span class="mxinfo" id="T1:U195">sqrt(pi)</span>*(<span class="mxinfo" id="T2:U196"><span class="mxinfo" id="T2:U197">erf(<span class="var type1" id="S11T2U279">z0</span>)</span>-<span class="mxinfo" id="T2:U199">erf(<span class="var type1" id="S15T2U282">z1</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo" id="T2:U201"><span class="var type1" id="S2T2U286">vals</span> = <span class="mxinfo" id="T1:U203">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
