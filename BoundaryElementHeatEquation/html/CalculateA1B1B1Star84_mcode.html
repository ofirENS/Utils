<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="40,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T20U3">a1k</span>,<span class="var type1" id="S3T20U4">b1k</span>,<span class="var type1" id="S4T20U5">b1s</span>] = CalculateA1B1B1Star(<span class="var type1" id="S5T1U8">k</span>,<span class="var type1" id="S6T2U9">x</span>,<span class="var type1" id="S7T2U10">t</span>,<span class="var type1" id="S8T2U11">gridT</span>,<span class="var type1" id="S9T1U12">N</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="40,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo" id="T20:U9"><span class="var type1" id="S2T20U15">a1k</span> = <span class="mxinfo" id="T20:U11">zeros(<span class="var type1" id="S9T1U18">N</span>,<span class="mxinfo" id="T1:U13"><span class="mxinfo" id="T1:U14">2</span>*<span class="var type1" id="S9T1U21">N</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T20:U16"><span class="var type1" id="S3T20U24">b1k</span> = <span class="mxinfo" id="T20:U18">zeros(<span class="var type1" id="S9T1U27">N</span>,<span class="mxinfo" id="T1:U20"><span class="mxinfo" id="T1:U21">2</span>*<span class="var type1" id="S9T1U30">N</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T20:U23"><span class="var type1" id="S4T20U33">b1s</span> = <span class="mxinfo" id="T20:U25">zeros(<span class="var type1" id="S9T1U36">N</span>,<span class="mxinfo" id="T1:U27"><span class="mxinfo" id="T1:U28">2</span>*<span class="var type1" id="S9T1U39">N</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T1U42">i</span> = <span class="mxinfo" id="T1:U31">1</span>:<span class="mxinfo" id="T1:U32">numel(<span class="var type1" id="S7T2U47">t</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,7" id="srcline7"> 7</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S13T1U50">j</span> = <span class="mxinfo" id="T1:U35">1</span>:<span class="mxinfo" id="T1:U36">numel(<span class="var type1" id="S7T2U55">t</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,8" id="srcline8"> 8</a></span><span class="line">        <span class="comment">% Calcualte A1</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,9" id="srcline9"> 9</a></span><span class="line">        <span class="mxinfo" id="T15:U38"><span class="mxinfo" id="T15:U39"><span class="var type1" id="S2T20U59">a1k</span>(<span class="var type1" id="S11T1U60">i</span>,<span class="mxinfo" id="T54:U42">(<span class="mxinfo" id="T1:U43"><span class="mxinfo" id="T1:U44"><span class="mxinfo" id="T1:U45">2</span>*<span class="var type1" id="S13T1U66">j</span></span>-1</span>):2*<span class="var type1" id="S13T1U70">j</span></span>)</span> = <span class="mxinfo" id="T15:U48">[<span class="mxinfo" id="T1:U49"><span class="fcn" id="F1N2:B74">Acoeff</span>(<span class="mxinfo" id="T1:U50">0</span>,<span class="var type1" id="S13T1U76">j</span>,<span class="mxinfo" id="T1:U52"><span class="var type1" id="S6T2U78">x</span>(<span class="var type1" id="S5T1U79">k</span>)</span>,<span class="mxinfo" id="T1:U55"><span class="var type1" id="S7T2U81">t</span>(<span class="var type1" id="S11T1U82">i</span>)</span>,<span class="var type1" id="S8T2U83">gridT</span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="40,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T15:U38"><span class="mxinfo" id="T15:U48">                            <span class="mxinfo" id="T1:U59"><span class="fcn" id="F1N2:B85">Acoeff</span>(<span class="mxinfo" id="T1:U60">1</span>,<span class="var type1" id="S13T1U87">j</span>,<span class="mxinfo" id="T1:U62"><span class="var type1" id="S6T2U89">x</span>(<span class="var type1" id="S5T1U90">k</span>)</span>,<span class="mxinfo" id="T1:U65"><span class="var type1" id="S7T2U92">t</span>(<span class="var type1" id="S11T1U93">i</span>)</span>,<span class="var type1" id="S8T2U94">gridT</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,11" id="srcline11">11</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="40,12" id="srcline12">12</a></span><span class="line">        <span class="comment">% Temp b1</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,13" id="srcline13">13</a></span><span class="line">        <span class="mxinfo" id="T1:U69"><span class="var type1" id="S15T1U97">b1ki</span> = <span class="mxinfo" id="T1:U71"><span class="fcn" id="F74N3:B99">Bcoeff</span>(<span class="mxinfo" id="T1:U72">1</span>,<span class="var type1" id="S13T1U101">j</span>,<span class="mxinfo" id="T1:U74"><span class="var type1" id="S6T2U103">x</span>(<span class="var type1" id="S5T1U104">k</span>)</span>,<span class="mxinfo" id="T1:U77"><span class="var type1" id="S7T2U106">t</span>(<span class="var type1" id="S11T1U107">i</span>)</span>,<span class="var type1" id="S8T2U108">gridT</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,14" id="srcline14">14</a></span><span class="line">        <span class="comment">% calculate B1</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,15" id="srcline15">15</a></span><span class="line">        <span class="mxinfo" id="T15:U81"><span class="mxinfo" id="T15:U82"><span class="var type1" id="S3T20U112">b1k</span>(<span class="var type1" id="S11T1U113">i</span>,<span class="mxinfo" id="T54:U85">(<span class="mxinfo" id="T1:U86"><span class="mxinfo" id="T1:U87"><span class="mxinfo" id="T1:U88">2</span>*<span class="var type1" id="S13T1U119">j</span></span>-1</span>):2*<span class="var type1" id="S13T1U123">j</span></span>)</span> = <span class="mxinfo" id="T15:U91">[<span class="mxinfo" id="T1:U92"><span class="fcn" id="F74N3:B127">Bcoeff</span>(<span class="mxinfo" id="T1:U93">0</span>,<span class="var type1" id="S13T1U129">j</span>,<span class="mxinfo" id="T1:U95"><span class="var type1" id="S6T2U131">x</span>(<span class="var type1" id="S5T1U132">k</span>)</span>,<span class="mxinfo" id="T1:U98"><span class="var type1" id="S7T2U134">t</span>(<span class="var type1" id="S11T1U135">i</span>)</span>,<span class="var type1" id="S8T2U136">gridT</span>)</span>, <span class="var type1" id="S15T1U137">b1ki</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,16" id="srcline16">16</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="40,17" id="srcline17">17</a></span><span class="line">        <span class="comment">% Calculate B1*</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo" id="T15:U103"><span class="mxinfo" id="T15:U104"><span class="var type1" id="S4T20U141">b1s</span>(<span class="var type1" id="S11T1U142">i</span>,<span class="mxinfo" id="T54:U107">(<span class="mxinfo" id="T1:U108"><span class="mxinfo" id="T1:U109"><span class="mxinfo" id="T1:U110">2</span>*<span class="var type1" id="S13T1U148">j</span></span>-1</span>):2*<span class="var type1" id="S13T1U152">j</span></span>)</span> = <span class="mxinfo" id="T15:U113">[<span class="var type1" id="S15T1U155">b1ki</span>,<span class="mxinfo" id="T1:U115">-<span class="var type1" id="S15T1U157">b1ki</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,19" id="srcline19">19</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,23" id="srcline23">23</a></span><span class="line"></span></span>
</pre>
