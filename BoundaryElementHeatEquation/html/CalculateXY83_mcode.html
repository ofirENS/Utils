<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="46,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T20U3">X</span>,<span class="var type1" id="S3T21U4">Y</span>]= CalculateXY(<span class="var type1" id="S4T1U7">N</span>,<span class="var type1" id="S5T1U8">N0</span>,<span class="var type1" id="S6T2U9">t</span>,<span class="var type1" id="S7T2U10">gridT</span>,<span class="var type1" id="S8T2U11">x</span>,<span class="var type1" id="S9T2U12">gridX</span>,<span class="var type1" id="S10T2U13">E</span>,<span class="var type1" id="S11T20U14">A</span>,<span class="var type1" id="S12T20U15">B</span>,<span class="var type1" id="S13T20U16">Bstar</span>,<span class="var type1" id="S14T20U17">C</span>,<span class="var type1" id="S15T20U18">D</span>,<span class="var type1" id="S16T2U19">u0</span>,<span class="var type1" id="S17T20U20">f</span>,<span class="var type1" id="S18T1U21">alpha</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="46,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% N - number pf time points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% N0 - number of space points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% t - time points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% gridT - grid for time points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% x - space points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% gridX - grid for space points</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% A- the calculated A matrix </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% B - the calculated B matrix </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,10" id="srcline10">10</a></span><span class="line"><span class="comment">% BStar- the calculated Bstar matrix </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,11" id="srcline11">11</a></span><span class="line"><span class="comment">% C - the calculated C matrix </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,12" id="srcline12">12</a></span><span class="line"><span class="comment">% D - the calculated D matrix </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,13" id="srcline13">13</a></span><span class="line"><span class="comment">% u0 - initial data u(x,0) </span></span></span>
<span class="srcline"><span class="lineno"><a href="46,14" id="srcline14">14</a></span><span class="line"><span class="comment">% f - multiplicative function for the source f(x,t)r(t)</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,15" id="srcline15">15</a></span><span class="line"><span class="comment">% alpha- constant for the boundary vcondition u_x-alpha*u = 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="46,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T43:U18"><span class="var type1" id="S19T43U24">s1</span> = <span class="mxinfo" id="T43:U20">zeros(<span class="var type1" id="S4T1U27">N</span>,<span class="var type1" id="S4T1U28">N</span>,<span class="var type1" id="S5T1U29">N0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T20:U24"><span class="var type1" id="S21T20U32">s2</span> = <span class="mxinfo" id="T20:U26">zeros(<span class="var type1" id="S4T1U35">N</span>,<span class="var type1" id="S5T1U36">N0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,19" id="srcline19">19</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S22T1U39">k</span> = <span class="mxinfo" id="T1:U30">1</span>:<span class="var type1" id="S5T1U42">N0</span><span class="comment">% space variable</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,20" id="srcline20">20</a></span><span class="line">    <span class="comment">% components of X</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo" id="T20:U32">[<span class="var type1" id="S23T20U46">a1k</span>,<span class="var type1" id="S24T20U47">b1k</span>,<span class="var type1" id="S25T20U48">b1s</span>] = <span class="fcn" id="F84N4:B50">CalculateA1B1B1Star</span>(<span class="var type1" id="S22T1U51">k</span>,<span class="var type1" id="S8T2U52">x</span>,<span class="var type1" id="S6T2U53">t</span>,<span class="var type1" id="S7T2U54">gridT</span>,<span class="var type1" id="S4T1U55">N</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo" id="T20:U41"><span class="var type1" id="S27T20U58">ax</span>  = <span class="mxinfo" id="T20:U43">(<span class="mxinfo" id="T20:U44"><span class="var type1" id="S23T20U62">a1k</span>-<span class="mxinfo" id="T20:U46">(<span class="mxinfo" id="T1:U47"><span class="mxinfo" id="T1:U48">1</span>/<span class="var type1" id="S18T1U67">alpha</span></span>)*(<span class="mxinfo" id="T20:U50"><span class="var type1" id="S24T20U70">b1k</span>+<span class="var type1" id="S25T20U71">b1s</span></span>)</span></span>)/<span class="keyword">...</span></span></span><span class="comment"><span class="mxinfo" id="T20:U41"><span class="mxinfo" id="T20:U43"> </span></span><span class="comment"><span class="mxinfo" id="T20:U41"><span class="mxinfo" id="T20:U43">%(a1k-(1/alpha)*(b1k-b1s))</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="46,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T20:U41"><span class="mxinfo" id="T20:U43">          (<span class="mxinfo" id="T20:U53"><span class="var type1" id="S11T20U74">A</span>-<span class="mxinfo" id="T20:U55">(<span class="mxinfo" id="T1:U56"><span class="mxinfo" id="T1:U57">1</span>/<span class="var type1" id="S18T1U79">alpha</span></span>)*(<span class="mxinfo" id="T20:U59"><span class="var type1" id="S12T20U82">B</span>+<span class="var type1" id="S13T20U83">Bstar</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo" id="T20:U62"><span class="mxinfo" id="T20:U63"><span class="var type1" id="S19T43U87">s1</span>(:,:,<span class="var type1" id="S22T1U90">k</span>)</span> = (<span class="mxinfo" id="T20:U66"><span class="mxinfo" id="T20:U67"><span class="mxinfo" id="T20:U68">-<span class="var type1" id="S27T20U95">ax</span></span>*<span class="var type1" id="S15T20U96">D</span></span> + <span class="mxinfo" id="T20:U71"><span class="fcn" id="F330N12:B98">Done</span>(<span class="var type1" id="S22T1U99">k</span>,<span class="var type1" id="S8T2U100">x</span>,<span class="var type1" id="S9T2U101">gridX</span>,<span class="var type1" id="S6T2U102">t</span>,<span class="var type1" id="S7T2U103">gridT</span>,<span class="var type1" id="S17T20U104">f</span>)</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,25" id="srcline25">25</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="46,26" id="srcline26">26</a></span><span class="line">    <span class="comment">% components of Y</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo" id="T20:U78"><span class="var type1" id="S29T20U107">ay</span> = <span class="var type1" id="S27T20U108">ax</span></span>;<span class="comment">% it is the same calculation as ax (a1k-(1/alpha)*(b1k+b1s))/<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="46,28" id="srcline28">28</a></span><span class="line"><span class="comment">%          (A-(1/alpha)*(B+Bstar));</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T21:U81"><span class="mxinfo" id="T21:U82"><span class="var type1" id="S21T20U112">s2</span>(:,<span class="var type1" id="S22T1U114">k</span>)</span> = <span class="mxinfo" id="T21:U85">(<span class="mxinfo" id="T20:U86"><span class="mxinfo" id="T20:U87"><span class="var type1" id="S29T20U119">ay</span>*<span class="var type1" id="S14T20U120">C</span></span>-<span class="mxinfo" id="T20:U90"><span class="fcn" id="F331N10:B122">Cone</span>(<span class="var type1" id="S22T1U123">k</span>,<span class="var type1" id="S8T2U124">x</span>,<span class="var type1" id="S9T2U125">gridX</span>,<span class="var type1" id="S6T2U126">t</span>)</span></span>)*<span class="mxinfo" id="T21:U95"><span class="var type1" id="S16T2U128">u0</span>'</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="46,30" id="srcline30">30</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="46,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T20:U97"><span class="var type1" id="S2T20U131">X</span> = <span class="mxinfo" id="T20:U99">(<span class="mxinfo" id="T1:U100"><span class="mxinfo" id="T1:U101">1</span>/<span class="var type1" id="S5T1U136">N0</span></span>)*<span class="mxinfo" id="T20:U103">sum(<span class="var type1" id="S19T43U139">s1</span>,3)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="46,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T21:U105"><span class="var type1" id="S3T21U143">Y</span> = <span class="mxinfo" id="T21:U107"><span class="mxinfo" id="T21:U108"><span class="var type1" id="S10T2U146">E</span>'</span>+<span class="mxinfo" id="T21:U110">(<span class="mxinfo" id="T1:U111"><span class="mxinfo" id="T1:U112">1</span>/<span class="var type1" id="S5T1U151">N0</span></span>)*<span class="mxinfo" id="T21:U114">sum(<span class="var type1" id="S21T20U154">s2</span>,2)</span></span></span></span>;</span></span>
</pre>
